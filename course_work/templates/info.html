{% include 'navbar.html' %}
{% load static %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<link rel="stylesheet" type="text/css" href="{% static 'css/info_style.css' %}">
<div class="container product-details">
  <div class="row">
    <div class="col-md-4 left-column">
      <div id="productCarousel" class="carousel slide" data-ride="carousel" data-interval="false">
        <ol class="carousel-indicators">
          {% for pic in images %}
          <li data-target="#productCarousel" data-slide-to="{{ forloop.counter0 }}" {% if forloop.first %}class="active"{% endif %}></li>
          {% endfor %}
        </ol>
        <div class="carousel-inner">
          {% for pic in images %}
          <div class="carousel-item {% if forloop.first %}active{% endif %}">
            <img src="{{ pic.image.url }}" alt="{{ obj.name }} image" class="d-block w-300" style="height: 300px; object-fit: cover;"> 
          </div>
          {% endfor %}
        </div>
        <a class="carousel-control-prev" href="#productCarousel" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#productCarousel" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>
    </div>
    <div class="col-md-8 right-column">
      <h2>{{ obj.name }}</h2>
      <h2>{{ obj.price }}р</h2>
      {% if review_count != 0 %}
      <div class="rating">
        
        <div class="star-rating">
          {% with ''|center:average_rating as range %}
          {% for _ in range %}
          <i class="fas fa-star filled"></i>
          {% endfor %}
          {% endwith %}
        </div>
        ({{ review_count }})
      </div>
      {% else %}
      <div class="rating">
        Пока нет отзывов
      </div>
      {% endif %}
      {% if request.user.is_staff %}
      <h2>Количество: {{ obj.amount }}</h2>
      <p>
        <a href="{% url 'update-product' obj.shared_id %}">Изменить информацию о товаре</a>
      </p>
      <p>
        <a href="{% url 'delete-product' obj.shared_id %}">Удалить товар из каталога</a>
      </p>
      {% elif obj.amount > 0 %}
      <h2>Доступность: в наличии</h2>
      {% else %}
      <h2>Доступность: нет в наличии</h2>
      {% endif %}
      <p>
        <a href="{% url 'product-reviews' obj.shared_id %}">Отзывы</a>
      </p>
      <form method="POST" action="{% url 'add-to-cart' %}">
        {% csrf_token %}
        <input type="hidden" name="product_id" value="{{ obj.shared_id.id }}">
        {% if obj.amount > 0 and request.user.is_staff == False %}
        <button type="submit" class="btn btn-primary">Добавить в корзину</button>
        {% else %}
        <button type="submit" class="btn btn-primary" disabled>Добавить в корзину</button>
        {% endif %}
      </form>
      <br>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th>Характеристика</th>
            <th>Значение</th>
          </tr>
        </thead>
        <tbody>
          {% for item, value in zipped_data %}
          {% if value != None and value != '-' %}
          <tr>
            <td>{{ item }}</td>
            <td>
              {% if value == True %}
              ✓
              {% elif value == False %}
              x
              {% else %}
              {{ value }}
              {% if 'Дата выхода' in item %} г
              {% elif 'разрешение' in item %} DPI
              {% elif 'опрос' in item %} Гц
              {% endif %}
              {% endif %}
            </td>
          </tr>
          {% endif %}
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>



<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>